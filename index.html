<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FamilyBoard ‚Äì Teend≈ëk + Bev√°s√°rl√≥lista</title>
  <style>
    :root{
      --primary:#0ea5e9;
      --bg:#f6f8fb;
      --card:#fff;
      --text:#222;
      --muted:#6b7280;
      --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica Neue,Arial;
      background:var(--bg); color:var(--text);
      display:flex; flex-direction:column; align-items:center; min-height:100vh;
    }
    header{width:100%; background:var(--primary); color:#fff; padding:14px 16px; text-align:center; font-size:20px; font-weight:700}
    main{width:min(950px,94vw); margin:18px auto; display:grid; gap:16px; grid-template-columns:1fr;}
    @media (min-width:900px){ main{ grid-template-columns: 1.2fr 1fr; } }
    .card{background:var(--card); border:1px solid var(--border); border-radius:14px; padding:14px; box-shadow:0 6px 24px rgba(0,0,0,.05)}
    h2{margin:0 0 10px; font-size:18px}
    .muted{color:var(--muted)}
    .row{display:flex; gap:8px; align-items:center}
    button{cursor:pointer; border:none; background:var(--primary); color:#fff; padding:8px 12px; border-radius:10px; font-weight:600}
    button.ghost{background:transparent; color:var(--primary); border:1px solid var(--primary)}
    input[type="text"]{flex:1; padding:10px 12px; border-radius:10px; border:1px solid var(--border); font-size:15px}
    .tiny{font-size:12px; color:var(--muted)}
    ul{list-style:none; margin:10px 0 0; padding:0}
    li.task{display:flex; align-items:center; gap:10px; border-bottom:1px solid var(--border); padding:8px 4px}
    li.task:last-child{border-bottom:none}
    li.task.done span{ text-decoration: line-through; color:#9ca3af }
    .right{margin-left:auto}
    /* Calendar */
    .cal-head{display:flex; align-items:center; justify-content:space-between; margin-bottom:8px}
    .cal-head h3{margin:0; font-size:16px}
    .cal-grid{display:grid; grid-template-columns:repeat(7,1fr); gap:4px}
    .dow{font-size:12px; text-align:center; color:var(--muted); padding:6px 0}
    .day{
      position:relative; background:#fff; border:1px solid var(--border); border-radius:10px;
      padding:10px; text-align:right; min-height:52px; font-weight:600; color:#111;
    }
    .day.out{color:#bbb; background:#fafafa}
    .day.selected{outline:2px solid var(--primary); box-shadow:0 0 0 3px rgba(14,165,233,.15)}
    .dot{position:absolute; left:8px; bottom:6px; width:8px; height:8px; border-radius:50%; background:var(--primary)}
    .count{position:absolute; left:6px; top:6px; font-size:11px; color:#fff; background:var(--primary); padding:2px 6px; border-radius:999px}
  </style>
</head>
<body>
  <header>üß≠ FamilyBoard</header>

  <main>
    <!-- BAL: napt√°r + napi teend≈ëk -->
    <section>
      <div class="card">
        <div class="cal-head">
          <button id="prev" class="ghost">‚óÄ</button>
          <h3 id="monthLabel">2025. okt√≥ber</h3>
          <button id="next" class="ghost">‚ñ∂</button>
        </div>
        <div class="cal-grid" id="calGrid"></div>
      </div>

      <div class="card" style="margin-top:12px">
        <h2>Teend≈ëk ‚Äì <span id="dateOut" class="muted">-</span></h2>
        <div class="row" style="margin-bottom:8px">
          <input type="text" id="taskInput" placeholder="√öj teend≈ë..." />
          <button id="addTask">Hozz√°ad√°s</button>
        </div>
        <ul id="taskList"></ul>
      </div>
    </section>

    <!-- JOBB: bev√°s√°rl√≥lista -->
    <section>
      <div class="card">
        <h2>üõí Bev√°s√°rl√≥lista</h2>
        <div class="row" style="margin-bottom:8px">
          <input type="text" id="shopInput" placeholder="√öj t√©tel..." />
          <button id="addItem">Hozz√°ad√°s</button>
        </div>
        <ul id="shopList"></ul>
        <p class="tiny">A lista automatikusan ment√©sre ker√ºl (localStorage).</p>
      </div>
    </section>
  </main>

  <script>
    // ----- Helper -----
    const $ = s => document.querySelector(s);
    const pad = n => String(n).padStart(2, "0");
    const ymdOf = d => `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
    const today = () => ymdOf(new Date());
    const DOW = ['H','K','Sze','Cs','P','Szo','V'];

    function uuid(){ return crypto.randomUUID ? crypto.randomUUID() : Math.random().toString(36).slice(2) }
    function load(k,f){ try{return JSON.parse(localStorage.getItem(k))||f}catch{return f} }
    function save(k,v){ localStorage.setItem(k,JSON.stringify(v)) }

    // ----- Data -----
    let tasksByDate = load('fb_tasks',{});
    let shopping = load('fb_shopping',[]);
    let selected = today();
    let viewMonth = selected.slice(0,7)+'-01';

    // ----- Calendar -----
    const calGrid = $('#calGrid');
    const monthLabel = $('#monthLabel');
    $('#prev').onclick = ()=>{ moveMonth(-1); };
    $('#next').onclick = ()=>{ moveMonth(1); };

    function moveMonth(offset){
      const [y,m]=viewMonth.split('-').map(Number);
      const d=new Date(y,m-1+offset,1);
      viewMonth = ymdOf(new Date(d.getFullYear(), d.getMonth(), 1));
      renderCalendar();
    }

    function renderCalendar(){
      calGrid.innerHTML='';
      DOW.forEach(d=>{const el=document.createElement('div');el.className='dow';el.textContent=d;calGrid.appendChild(el);});
      const [y,m]=viewMonth.split('-').map(Number);
      const first=new Date(y,m-1,1);
      monthLabel.textContent=`${y}. ${first.toLocaleString('hu-HU',{month:'long'})}`;
      const start=new Date(first);
      const shift=(start.getDay()+6)%7;
      start.setDate(start.getDate()-shift);
      for(let i=0;i<42;i++){
        const d=new Date(start);
        d.setDate(start.getDate()+i);
        const ymd=ymdOf(d);
        const cell=document.createElement('button');
        cell.className='day';
        cell.textContent=d.getDate();
        if(d.getMonth()!==first.getMonth())cell.classList.add('out');
        if(ymd===selected)cell.classList.add('selected');
        const arr=tasksByDate[ymd]||[];
        if(arr.length){
          const done=arr.filter(x=>x.done).length;
          const c=document.createElement('div');
          c.className='count'; c.textContent = done===arr.length?'‚úì':arr.length-done;
          cell.appendChild(c);
        }
        cell.onclick=()=>{selected=ymd; renderCalendar(); renderTasks();};
        calGrid.appendChild(cell);
      }
    }

    // ----- Tasks -----
    const list=$('#taskList');
    const taskInput=$('#taskInput');
    const addTask=$('#addTask');
    const dateOut=$('#dateOut');

    addTask.onclick=()=>{
      const text=taskInput.value.trim();
      if(!text)return;
      const arr=tasksByDate[selected]||(tasksByDate[selected]=[]);
      arr.push({id:uuid(),text,done:false});
      taskInput.value='';
      save('fb_tasks',tasksByDate);
      renderTasks(); renderCalendar();
    };
    taskInput.onkeydown=e=>{if(e.key==='Enter')addTask.click();};

    function renderTasks(){
      const arr=tasksByDate[selected]||[];
      dateOut.textContent=selected;
      list.innerHTML='';
      if(!arr.length){const p=document.createElement('p');p.textContent='Nincs teend≈ë.';p.className='muted';list.appendChild(p);return;}
      arr.forEach((t,i)=>{
        const li=document.createElement('li');
        li.className='task'+(t.done?' done':'');
        const cb=document.createElement('input');cb.type='checkbox';cb.checked=t.done;
        cb.onchange=()=>{t.done=!t.done;save('fb_tasks',tasksByDate);renderTasks();renderCalendar();};
        const span=document.createElement('span');span.textContent=t.text;
        const del=document.createElement('button');del.textContent='üóëÔ∏è';del.className='ghost';
        del.onclick=()=>{arr.splice(i,1);save('fb_tasks',tasksByDate);renderTasks();renderCalendar();};
        li.append(cb,span,del);
        list.appendChild(li);
      });
    }

    // ----- Shopping -----
    const shopInput=$('#shopInput');
    const addItem=$('#addItem');
    const shopList=$('#shopList');

    addItem.onclick=()=>{
      const text=shopInput.value.trim();
      if(!text)return;
      shopping.push({id:uuid(),text,done:false});
      shopInput.value='';
      save('fb_shopping',shopping);
      renderShopping();
    };
    shopInput.onkeydown=e=>{if(e.key==='Enter')addItem.click();};

    function renderShopping(){
      shopList.innerHTML='';
      if(!shopping.length){
        const p=document.createElement('p');p.textContent='√úres bev√°s√°rl√≥lista.';p.className='muted';
        shopList.appendChild(p);return;
      }
      shopping.forEach((i,idx)=>{
        const li=document.createElement('li');
        li.className='task'+(i.done?' done':'');
        const cb=document.createElement('input');cb.type='checkbox';cb.checked=i.done;
        cb.onchange=()=>{i.done=!i.done;save('fb_shopping',shopping);renderShopping();};
        const span=document.createElement('span');span.textContent=i.text;
        const del=document.createElement('button');del.textContent='üóëÔ∏è';del.className='ghost';
        del.onclick=()=>{shopping.splice(idx,1);save('fb_shopping',shopping);renderShopping();};
        li.append(cb,span,del);
        shopList.appendChild(li);
      });
    }

    // ----- Init -----
    renderCalendar();
    renderTasks();
    renderShopping();
  </script>
</body>
</html>
